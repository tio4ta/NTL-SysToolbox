Module d‚ÄôAudit d‚ÄôObsolescence R√©seau
Objectif

Fournir un inventaire r√©seau minimal et qualifier le statut de support / EOL (End of Life) des √©l√©ments d√©tect√©s.
Ce module permet d‚Äôidentifier les composants pr√©sents sur un r√©seau, d√©terminer leurs OS et versions, puis g√©n√©rer un rapport d√©taill√© pour d√©tecter les syst√®mes non support√©s ou en fin de vie.

Fonctions principales

Scanner un r√©seau

Utilise Nmap pour d√©tecter les h√¥tes actifs, leurs adresses IP, OS et versions.

Tente d‚Äôidentifier le nom d‚Äôh√¥te (hostname) ou le commonName (SSL certificate).

Import CSV

Permet d‚Äôimporter une liste d‚Äôh√¥tes depuis un fichier CSV avec colonnes : IP, Hostname, OS_Name, OS_Version.

Nettoie et valide les donn√©es pour g√©n√©rer un inventaire exploitable.

Extraction des OS et versions

D√©tecte automatiquement les OS suivants :

Windows (7, 8, 8.1, 10, 11, Vista, XP)

Windows Server (2003 √† 2022, avec R2 si applicable)

Ubuntu et Debian (versions d√©tectables par Nmap)

Linux g√©n√©rique (version non d√©tect√©e par Nmap)

V√©rification du statut EOL

Interroge l‚ÄôAPI endoflife.date
 pour chaque produit et version.

Cat√©gorise les h√¥tes :

‚úÖ Support√©

‚ö° EOL proche (<1 an)

üî∂ EOL imminent (<90 jours)

‚ùå Non support√© / EOL d√©pass√©

‚ö†Ô∏è Version non d√©tectable / V√©rification manuelle requise

‚ùì Version inconnue

Affichage interactif

Tableau lisible en console : IP, hostname, OS, version, date EOL, statut.

G√©n√©ration de rapports

HTML : tableau complet avec code couleur et badges pour les statuts.

CSV : export exploitable pour traitement ou suivi.

Statistiques rapides : nombre de composants totaux, support√©s, EOL imminent, non support√©s, etc.

Lister toutes les versions d‚Äôun OS

Permet de r√©cup√©rer depuis l‚ÄôAPI toutes les versions et leur EOL pour Windows, Windows Server, Ubuntu, Debian.

Installation / Pr√©-requis

Python 3.x

Modules Python : subprocess, re, csv, os, json, datetime, xml.etree.ElementTree, urllib

Nmap install√© sur le syst√®me (nmap accessible depuis le PATH)

Connexion Internet pour interroger l‚ÄôAPI endoflife.date

Note : Le script est con√ßu pour Windows mais peut √™tre adapt√© √† Linux.

Utilisation

Lancer le module

python audit_obsolescence.py


Menu principal

1. Scanner r√©seau
2. Importer CSV
3. Afficher h√¥tes
4. Lister versions d'un OS
5. G√©n√©rer rapport
0. Quitter


Scanner r√©seau : indique une plage r√©seau (ex: 10.5.70.0/24) pour d√©tecter les h√¥tes.

Importer CSV : fournit un fichier CSV avec les colonnes obligatoires IP, Hostname, OS_Name, OS_Version.

Afficher h√¥tes : montre le tableau console mis √† jour.

Lister versions OS : liste les versions et EOL d‚Äôun OS sp√©cifique.

G√©n√©rer rapport : cr√©e un HTML et un CSV dans le dossier C:\Users\Administrateur\module3_audit.

Structure du rapport

HTML : tableau color√© avec badge pour chaque statut

CSV : colonnes IP, Hostname/CN, OS, Version, EOL, Statut

Statistiques globales (nombre de composants, EOL imminent, support√©, etc.)

Dossier de sortie

Tous les fichiers g√©n√©r√©s sont stock√©s dans :

C:\Users\Administrateur\module3_audit


Rapport HTML : rapport.html

Rapport CSV : rapport.csv

Fichier Nmap XML temporaire : scan.xml

Exemple de sortie console
IP              Hostname / CN                 OS                   Version                       EOL             Statut
==============================================================================================================
10.5.70.1       serveur1.local               Windows Server       2016 R2                        2027-01-14      ‚úÖ SUPPORT√â
10.5.70.2       ubuntu-vm                    Ubuntu               20.04                          2025-04-30      ‚ö° EOL < 1 AN
10.5.70.3       debian-vm                    Debian               9                              2022-06-30      ‚ùå NON SUPPORT√â

Remarques

Le script utilise un cache en m√©moire pour √©viter les appels API r√©p√©titifs.

Les OS Linux non d√©tectables par Nmap n√©cessitent une v√©rification manuelle (cat /etc/os-release).

Les fichiers inutiles peuvent √™tre ignor√©s via .gitignore si versionn√© avec Git.
